# CC パラメータレンジマッピング計画

## ゴール
CC (0.0–1.0) の値をパラメータメタデータで定義されたレンジに自動変換し、利用者は CC 割り当てのみ意識すれば良い状態を実現する。

## 実装ステップ
- [ ] 参照調査
  - [ ] CC 値を取得・加工する経路（`ParameterManager.draw`/`ParameterWindowController.apply_overrides`）を確認
  - [ ] `ParameterStore` でメタ情報と値をどのタイミングで解決しているか把握
- [ ] メタデータ取得
  - [ ] `ParameterStore` からパラメータ ID ごとの `RangeHint` を取得できるインターフェイスを用意
  - [ ] CC マッピング時に参照するデータ構造（キャッシュ）を設計
- [ ] マッピングロジック実装
  - [ ] CC 値を 0.0–1.0 から `RangeHint` の [min, max] へ線形マッピングする関数を実装
  - [ ] bool/int パラメータの丸め、step 指定へのスナップ処理を追加
  - [ ] メタデータが無い場合はフォールバックレンジ (0.0–1.0) を使用
- [ ] CC 適用フローへの組み込み
  - [ ] `ParameterWindowController.apply_overrides` で CC 値をマッピングしたうえで GUI/ランタイムに渡す
  - [ ] CC と GUI override の優先順位を整理し、既存の `ParameterStore` オーバーライドとの整合性を確認
- [ ] 設定/マッピング指定
  - [ ] CC 番号とパラメータ ID を紐付ける仕組み（既存の使用例を確認し、必要なら設定用マップを導入）
  - [ ] 設定が無い CC はそのまま通し、パラメータの初期値を保つ
- [ ] テスト計画
  - [ ] コントローラ単体で CC → レンジ変換を検証するテストを追加
  - [ ] 統合テストで CC 変更が `ParameterRuntime` の入力値へ反映されることを確認

## オープン質問
- CC とパラメータの紐付けをどこで定義・管理するか？（設定ファイル/コード定義/UI）
- CC 変換後の値を GUI オーバーライドとどのようにマージするか？（優先順位、リセット手順）

## 観測事項
- 現状 `apply_overrides` は CC 値をそのまま返しているため、ここにレンジ変換を追加するのが自然。
- `ParameterStore` は `RangeHint` を保持しているが、外部から取得する簡易 API は未提供。

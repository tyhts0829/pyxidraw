# Parameter GUI フォント検索追加計画

## 目的
- Parameter GUI のフォントプルダウンに検索入力を付け、部分一致で候補を絞り込めるようにする。
- Dear PyGui の機能を活用しつつ、既存の選択動作やフォールバック（フィルター未生成時の挙動）を維持する。

## 現状
- `src/shapes/text.__param_meta__["font"]` の `choices` はフィルター済み JSON から取得したフォント名（表示名）をそのまま並べるのみで、検索 UI は無い。
- `ParameterWindowContentBuilder._create_widget` の enum 生成は `dpg.add_combo` を用い、`items` に全件を渡すだけ。Radio ボタン化の閾値（<=5 件）はあるが検索機能はない。
- Dear PyGui は `add_combo` 単体では検索入力を持たないため、検索入力を別途設けて `items` を動的に差し替える必要がある（2.1.0 前提）。

## 方針案
- 検索を有効化する enum の識別方法を決める（例: `__param_meta__` に `searchable: true` を許可し、Descriptor に伝搬）。
- `dpg_window_content._create_widget` で検索入力付きコンボを生成するヘルパを用意し、該当パラメータでは `dpg.add_input_text` を併置してフィルター文字列を管理する。
- フィルター処理は部分一致・大文字小文字無視で実装し、ヒット無しの場合は「候補なし」のダミー表示を入れるか、空リストでコンボを無効化するかを決める。
- 選択済み値がフィルターで消えた場合の挙動（維持する/リセットする）を定義する。基本方針は「維持しつつリストに戻す」か「最初の候補に差し替える」かを決める。
- フォント以外への影響を避け、デフォルトは従来どおりのコンボ。検索が必要なパラメータのみ新 UI を適用する。

## 実装タスク（チェックリスト）
- [x] Dear PyGui 2.1.0 で combo + 独立フィルター入力を実現する実装方針を確定（`input_text` + `configure_item` で items 差し替え）。
- [x] ParameterDescriptor への検索可否フラグの伝搬方法を決定（`__param_meta__["searchable"]` を許可）。`text.font` に付与。`.font` サフィックスにもフォールバックで適用。
- [x] `_create_widget` に検索付きコンボを組み込むヘルパを追加し、フィルター入力と combo の `items` 更新を連携させる。
- [x] フィルター適用時の選択値の扱いを設計・実装（既存選択が消える場合はリスト先頭に再挿入して維持）。
- [x] UI 配置/幅の調整（検索入力とコンボを縦積み、幅はセルいっぱいにフィットさせる）。
- [ ] 動作確認（フォント候補が多数ある環境でフィルターが効くこと、未指定時は従来どおり全件表示になること）。

## メモ / 決めごと候補
- フィルターは小文字化した文字列で部分一致。空文字なら全件。
- 選択済みの値はフィルターで消えても先頭に再挿入し、値を維持する。
- 「候補なし」の場合は空リストのまま（選択済みがあればその値のみが残る）。
- 文字列入力の反映タイミングは `callback` で都度更新（デバウンス不要）。
